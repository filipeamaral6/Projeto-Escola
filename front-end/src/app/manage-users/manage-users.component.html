<app-alert></app-alert>
<div
  class="row"
  style="padding-left: 15px; padding-right:15px; padding-top: 15px;"
>
  <div class="col-md-4 form-group searchContainer" style="padding-left: 0px;">
    <i class="material-icons searchIcon">search</i>
    <input
      type="text"
      class="form-control searchBox"
      name="searchString"
      placeholder="Type to search..."
      [(ngModel)]="searchString"
    />
  </div>
</div>
<div class="table-title" style="margin-top: 5px;">
  <div class="row">
    <div class="col-sm-6">
      <h3>User <b>Management</b></h3>
    </div>
    <div class="col-sm-6">
      <a (click)="onNewUser()" class="btn btn-primary" id="new-user"
        ><i class="material-icons">&#xE147;</i> <span>New User</span></a
      >
    </div>
  </div>
</div>
<div *ngIf="isLoading" style="text-align: center;">
  <br />
  <app-loading-spinner></app-loading-spinner>
</div>
<table class="table table-striped table-hover" *ngIf="!isLoading">
  <thead>
    <tr>
      <th>#</th>
      <th>Name</th>
      <th>Username</th>
      <th>Role</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr
      *ngFor="
        let user of users
          | filter: 'fullName':searchString
          | paginate: { itemsPerPage: 10, currentPage: p }
      "
    >
      <td>{{ user.id }}</td>
      <td>{{ user.fullName }}</td>
      <td>{{ user.username }}</td>
      <td *ngIf="user.roles[0].name === 'ROLE_ADMIN'">Admin</td>
      <td *ngIf="user.roles[0].name === 'ROLE_USER'">User</td>
      <td>
        <a
          class="view"
          title="View User"
          data-toggle="tooltip"
          style="cursor: pointer;"
          [routerLink]="['/users/detail/', user.id]"
        >
          <i class="material-icons">visibility</i>
        </a>
        <a
          class="edit"
          title="Edit User"
          data-toggle="tooltip"
          [routerLink]="['/users/edit/', user.id]"
          style="cursor: pointer;"
        >
          <i class="material-icons">edit</i>
        </a>
        <a
          class="delete"
          title="Delete User"
          data-toggle="tooltip"
          (click)="onDeleteUser(user.id, user.firstName, currentUser.username)"
          style="cursor: pointer;"
          *ngIf="currentUser.username !== user.username"
        >
          <i class="material-icons">delete</i></a
        >
      </td>
    </tr>
  </tbody>
</table>
<div class="pagination">
  <pagination-controls
    (pageChange)="p = $event"
    class="myPagination"
  ></pagination-controls>
</div>
